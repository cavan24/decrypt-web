(function(){var e={937:function(){},5239:function(e,t,r){"use strict";var n=r(3529),o=r(7030);function i(e,t,r,n,i,a){const s=(0,o.g2)("Decrypt");return(0,o.uX)(),(0,o.Wv)(s,{msg:"APP请求参数解密"})}var a=r(4071);const s={class:"decrypt-container"},c={class:"header"},l={class:"content"},p={class:"input-section"},u={class:"button-section"},d=["disabled"],f={class:"output-section"},h={key:0,class:"error-message"};function y(e,t,r,i,y,g){return(0,o.uX)(),(0,o.CE)("div",s,[(0,o.Lk)("div",c,[(0,o.Lk)("h1",null,(0,a.v_)(r.msg),1)]),(0,o.Lk)("div",l,[(0,o.Lk)("div",p,[t[4]||(t[4]=(0,o.Lk)("label",{for:"ciphertext"},"密文：",-1)),(0,o.bo)((0,o.Lk)("textarea",{id:"ciphertext","onUpdate:modelValue":t[0]||(t[0]=e=>y.ciphertext=e),placeholder:"请输入需要解密的 Base64 编码的密文...",class:"textarea-input",rows:"14"},null,512),[[n.Jo,y.ciphertext]])]),(0,o.Lk)("div",u,[(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>g.handleDecrypt&&g.handleDecrypt(...e)),disabled:!y.ciphertext.trim()||y.isDecrypting,class:"decrypt-btn"},(0,a.v_)(y.isDecrypting?"解密中...":"解密"),9,d),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>g.handleClear&&g.handleClear(...e)),class:"clear-btn"}," 清空 ")]),(0,o.Lk)("div",f,[t[5]||(t[5]=(0,o.Lk)("label",{for:"plaintext"},"明文：",-1)),(0,o.bo)((0,o.Lk)("textarea",{id:"plaintext","onUpdate:modelValue":t[3]||(t[3]=e=>y.plaintext=e),placeholder:"解密后的明文将显示在这里...",class:"textarea-output",rows:"14",readonly:""},null,512),[[n.Jo,y.plaintext]])]),y.errorMessage?((0,o.uX)(),(0,o.CE)("div",h,(0,a.v_)(y.errorMessage),1)):(0,o.Q3)("",!0)])])}var g=r(7620),A=(r(600),r(207),r(9166),r(6506),r(6517),r(579),r(4047),r(9495),r(2367),r(7437),r(3253),r(8350)),m=r.n(A);const v={APP_REQUEST_RSA_PRIVATE_PAIR:"MIICdQIBADANBgkqhkiG9w0BAQEFAASCAl8wggJbAgEAAoGBAIu/T+tbmMkQ wcm4y548sFVVqXGupFbIHaGlMeBt1aTfgVl4Zvf3f18L6Pdzs6NkT0QsAxfq kpyrHgslgc/lqeJL9RxpvTdzQ6GX3nXKtpWNqAcJyixadbVpGmSNV2mjK79s 1rCuc5WvHTWvMlhY0QCb+jviV18UAvYzOEKZWCz/AgMBAAECgYBpZ2AJPios JYZ09vwlmtLJWnYWd8oeZovq+yV2iIFm/OmcKTNI/pVEhEAwPEWXDLa4zZV7 uYLhxjM/5wdVXn1WQ+7WXceAQPYqJ1X+hzKxeGdEPqis+mwfQ4qvfSAFvTVH rxQmPennRP5PxenPe5bX+1wp0fv5Gr4dkhQLvdkdWQJBAL1urCqNIlubsUID UxjTzTx6Ozusz0QfcMbwmkd47OgITalgd4imHmgjapIcxCbwsjzaGlqbGLof fe3eSe7mtqMCQQC82vpVtN7B/oZcg+2Zc1QMqwj0BmGiRCISKxmpbSL1SEMS 1HJ3wi4Zcyxgx8NovCd6Cik3CdA56vegCAvz5EH1AkBy77eeicuS8cB3YTUG F1yrmS5fYtbPapQu4MV7IC/+CSu13UYpr0E7xmFfDf0l81zx9xOObhRuubTa oskRHwMpAkAMEvv6SswLHxi8BXtFWkg/Xxf9cgL/+tcqzjKf0GhxwiL3qzl+ Sp3j5qcpsNvfcFgdx1SHPktfyJP4WUtaVneZAkAX/1tIINC1+50143pOB35f E6WbYxjCA25TSurMH9FbaRtpVvVVeiR0E8zhmmy0abF2tv+fPNszeIv7uLqO l+rH".replace(/\s/g,"")};class w{static decode(e){const t=m().util.decode64(e);return new Uint8Array(t.split("").map(e=>e.charCodeAt(0)))}static encode(e){if("string"===typeof e)return m().util.encode64(e);let t;t=e instanceof ArrayBuffer?new Uint8Array(e):e instanceof Uint8Array?e:new Uint8Array(e);const r=Array.from(t).map(e=>String.fromCharCode(e)).join("");return m().util.encode64(r)}}class C{static decryptByPrivateKey(e,t){try{let o;o=e instanceof ArrayBuffer?new Uint8Array(e):e instanceof Uint8Array?e:"string"===typeof e?new Uint8Array(e.split("").map(e=>e.charCodeAt(0))):new Uint8Array(e);const i=w.decode(t),a=Array.from(i).map(e=>String.fromCharCode(e)).join("");let s;try{const e=m().asn1.fromDer(a);s=m().pki.privateKeyFromAsn1(e)}catch(r){try{const e=this.derToPem(i,"PRIVATE KEY");s=m().pki.privateKeyFromPem(e)}catch(n){throw new Error(`私钥解析失败: ${r.message}。尝试 PEM 格式也失败: ${n.message}`)}}const c=[];let l=0;const p=o.length;while(p-l>0){let e;e=p-l>this.MAX_DECRYPT_BLOCK?this.MAX_DECRYPT_BLOCK:p-l;const t=o.slice(l,l+e),r=Array.from(t).map(e=>String.fromCharCode(e)).join(""),n=s.decrypt(r,"RSAES-PKCS1-V1_5"),i=new Uint8Array(n.split("").map(e=>e.charCodeAt(0)));c.push(i),l+=e}const u=c.reduce((e,t)=>e+t.length,0),d=new Uint8Array(u);let f=0;for(const e of c)d.set(e,f),f+=e.length;return d}catch(o){throw new Error(`RSA解密失败: ${o.message}`)}}static derToPem(e,t){let r;r=e instanceof ArrayBuffer?new Uint8Array(e):e instanceof Uint8Array?e:new Uint8Array(e);const n=Array.from(r).map(e=>String.fromCharCode(e)).join(""),o=m().util.encode64(n),i=o.match(/.{1,64}/g)||[];return`-----BEGIN ${t}-----\n${i.join("\n")}\n-----END ${t}-----`}}(0,g.A)(C,"MAX_DECRYPT_BLOCK",128);class x{static needSkipCleanXss(e){const t=["floginName","password","tradePwd","originPwd","newPwd","reNewPwd"];return t.includes(e)}static cleanXSS(e){if(!e)return e;e=e.replace(/eval\(.*?\)/g,""),e=e.replace(/["'][\s]*javascript:(.*?)["']/g,'""'),e=e.replace(/script/gi,"-"),e=e.replace(/src=/gi,"-");const t=["update","detele","select","truncate","insert"];return t.includes(e.toLowerCase())&&(e=""),e=e.trim().replace(/;/g,"；"),e}}class b{static decrypt(e,t=null){const r={};try{if(!e||""===e.trim())throw new Error("app签名校验失败! param is null");const o=w.decode(e),i=t||v.APP_REQUEST_RSA_PRIVATE_PAIR,a=C.decryptByPrivateKey(o,i);let s="";try{const e=new TextDecoder("utf-8");s=e.decode(a)}catch(n){s=Array.from(a).map(e=>String.fromCharCode(e)).join("")}if(s)try{s=decodeURIComponent(s)}catch(n){console.warn("URL 解码失败，使用原始字符串:",n)}const c=s.split("&");for(const e of c){const t=e.split("="),n=t[0];if(t.length>=2&&"logintoken"!==n.toLowerCase()){const t=e.substring(e.indexOf("=",0)+1);let o=t;x.needSkipCleanXss(n)||(o=x.cleanXSS(t)),r[n]=[o]}}return r}catch(o){throw console.error("解密失败:",o),new Error(`app签名校验失败! ${o.message}`)}}static decryptAndPrint(e,t=null){console.log("解密前：",e);const r=this.decrypt(e,t);return console.log("解密后：",JSON.stringify(r,null,2)),r}}var P={name:"DecryptTool",props:{msg:String},data(){return{ciphertext:"",plaintext:"",isDecrypting:!1,errorMessage:""}},methods:{handleDecrypt(){this.ciphertext.trim()?(this.isDecrypting=!0,this.errorMessage="",this.plaintext="",setTimeout(()=>{try{const e=b.decrypt(this.ciphertext.trim()),t=JSON.stringify(e,null,2);this.plaintext=t}catch(e){this.errorMessage=e.message||"解密失败，请检查密文格式是否正确",this.plaintext="",console.error("解密错误:",e)}finally{this.isDecrypting=!1}},0)):this.errorMessage="请输入密文"},handleClear(){this.ciphertext="",this.plaintext="",this.errorMessage=""}}},k=r(5436);const E=(0,k.A)(P,[["render",y],["__scopeId","data-v-6416ce7d"]]);var S=E,L={name:"App",components:{Decrypt:S}};const T=(0,k.A)(L,[["render",i]]);var M=T;(0,n.Ef)(M).mount("#app")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.m=e,function(){var e=[];r.O=function(t,n,o,i){if(!n){var a=1/0;for(p=0;p<e.length;p++){n=e[p][0],o=e[p][1],i=e[p][2];for(var s=!0,c=0;c<n.length;c++)(!1&i||a>=i)&&Object.keys(r.O).every(function(e){return r.O[e](n[c])})?n.splice(c--,1):(s=!1,i<a&&(a=i));if(s){e.splice(p--,1);var l=o();void 0!==l&&(t=l)}}return t}i=i||0;for(var p=e.length;p>0&&e[p-1][2]>i;p--)e[p]=e[p-1];e[p]=[n,o,i]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,i,a=n[0],s=n[1],c=n[2],l=0;if(a.some(function(t){return 0!==e[t]})){for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(c)var p=c(r)}for(t&&t(n);l<a.length;l++)i=a[l],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(p)},n=self["webpackChunkdecrypt"]=self["webpackChunkdecrypt"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=r.O(void 0,[504],function(){return r(5239)});n=r.O(n)})();
//# sourceMappingURL=app.ad9708f1.js.map